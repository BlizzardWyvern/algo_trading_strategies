"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.Exchange = void 0;
const big_js_1 = __importDefault(require("big.js"));
const bignumber_js_1 = __importDefault(require("bignumber.js"));
const zeroEx_1 = require("../clients/zeroEx");
const Constants_1 = require("../lib/Constants");
const ContractCallHelpers_1 = require("../lib/ContractCallHelpers");
const heleprs_1 = require("../lib/heleprs");
const types_1 = require("../types");
class Exchange {
    constructor(contracts) {
        this.contracts = contracts;
    }
    getAddress() {
        return this.contracts.starkwarePerpetual.options.address;
    }
    getProxyDepositAddress() {
        return this.contracts.proxyDepositContract.options.address;
    }
    async register({ ethAddress, starkKey, signature, }, options) {
        return this.contracts.send(this.contracts.starkwarePerpetual, this.contracts.starkwarePerpetual.methods.registerUser(ethAddress, (0, ContractCallHelpers_1.starkKeyToUint256)(starkKey), signature), options);
    }
    async registerAndDeposit({ ethAddress, starkKey, signature, positionId, humanAmount, }, options) {
        return this.contracts.send(this.contracts.starkwarePerpetual, this.contracts.starkwarePerpetual.methods.registerAndDepositERC20(ethAddress, (0, ContractCallHelpers_1.starkKeyToUint256)(starkKey), signature, Constants_1.COLLATERAL_ASSET_ID[this.contracts.networkId], (0, ContractCallHelpers_1.bignumberableToUint256)(positionId), (0, ContractCallHelpers_1.humanCollateralAmountToUint256)(humanAmount)), options);
    }
    async deposit({ starkKey, positionId, humanAmount, }, options) {
        const depositFunctionSignature = 'deposit(uint256,uint256,uint256,uint256)';
        return this.contracts.send(this.contracts.starkwarePerpetual, this.contracts.starkwarePerpetual.methods[depositFunctionSignature]((0, ContractCallHelpers_1.starkKeyToUint256)(starkKey), Constants_1.COLLATERAL_ASSET_ID[this.contracts.networkId], (0, ContractCallHelpers_1.bignumberableToUint256)(positionId), (0, ContractCallHelpers_1.humanCollateralAmountToUint256)(humanAmount)), options);
    }
    async proxyDeposit({ humanAmount, starkKey, positionId, }, options) {
        return this.contracts.send(this.contracts.proxyDepositContract, this.contracts.proxyDepositContract.methods.deposit((0, ContractCallHelpers_1.humanCollateralAmountToUint256)(humanAmount), (0, ContractCallHelpers_1.starkKeyToUint256)(starkKey), (0, ContractCallHelpers_1.bignumberableToUint256)(positionId)), options);
    }
    async approveSwap({ tokenFrom, allowanceTarget, }, options) {
        return this.contracts.send(this.contracts.proxyDepositContract, this.contracts.proxyDepositContract.methods.approveSwap(tokenFrom, allowanceTarget), options);
    }
    async proxyDepositERC20({ humanMinUsdcAmount, starkKey, positionId, zeroExResponseObject, }, options) {
        return this.contracts.send(this.contracts.proxyDepositContract, this.contracts.proxyDepositContract.methods.depositERC20(zeroExResponseObject.sellTokenAddress, zeroExResponseObject.sellAmount, (0, ContractCallHelpers_1.humanCollateralAmountToUint256)(humanMinUsdcAmount), (0, ContractCallHelpers_1.starkKeyToUint256)(starkKey), (0, ContractCallHelpers_1.bignumberableToUint256)(positionId), zeroExResponseObject.to, zeroExResponseObject.data), options);
    }
    async approveSwapAndProxyDepositERC20({ humanMinUsdcAmount, starkKey, positionId, zeroExResponseObject, }, options) {
        return this.contracts.send(this.contracts.proxyDepositContract, this.contracts.proxyDepositContract.methods.approveSwapAndDepositERC20(zeroExResponseObject.sellTokenAddress, zeroExResponseObject.sellAmount, (0, ContractCallHelpers_1.humanCollateralAmountToUint256)(humanMinUsdcAmount), (0, ContractCallHelpers_1.starkKeyToUint256)(starkKey), (0, ContractCallHelpers_1.bignumberableToUint256)(positionId), zeroExResponseObject.to, zeroExResponseObject.allowanceTarget, zeroExResponseObject.data), options);
    }
    async proxyDepositEth({ starkKey, positionId, zeroExResponseObject, }, options) {
        if ((options === null || options === void 0 ? void 0 : options.value) !== undefined && !(0, big_js_1.default)(options.value).eq(zeroExResponseObject.value)) {
            throw Error(`proxyDepositEth: A transaction value ${options.value} was provided which does not match the swap cost of ${zeroExResponseObject.value}`);
        }
        return this.contracts.send(this.contracts.proxyDepositContract, this.contracts.proxyDepositContract.methods.depositEth(zeroExResponseObject.buyAmount, (0, ContractCallHelpers_1.starkKeyToUint256)(starkKey), (0, ContractCallHelpers_1.bignumberableToUint256)(positionId), zeroExResponseObject.to, zeroExResponseObject.data), { ...options, value: zeroExResponseObject.value });
    }
    /**
     * @description get expected and worst USDC for some amount of input sellToken.
     * @notice For eth pass in 'ETH' as the sellToken.
     */
    async estimateConversionAmount({ humanSellAmount, sellToken, slippageFraction, }) {
        (0, zeroEx_1.validateSlippage)(slippageFraction);
        const sellAmount = (0, ContractCallHelpers_1.humanCollateralAmountToUint256)(humanSellAmount);
        const zeroExResponseObject = await (0, zeroEx_1.getZeroExSwapQuote)({
            sellAmount,
            sellToken,
            buyTokenAddress: (0, heleprs_1.getUsdcAddress)(this.contracts.networkId),
            slippageFraction,
            networkId: this.contracts.networkId,
        });
        const expectedUsdcHumanAmount = (0, big_js_1.default)(zeroExResponseObject.buyAmount);
        expectedUsdcHumanAmount.e -= types_1.BASE_DECIMALS;
        const worstUsdcHumanAmount = (0, big_js_1.default)(sellAmount).div(zeroExResponseObject.guaranteedPrice);
        worstUsdcHumanAmount.e -= types_1.BASE_DECIMALS;
        return {
            expectedUsdcHumanAmount: expectedUsdcHumanAmount.round(types_1.BASE_DECIMALS, 0).toString(),
            worstUsdcHumanAmount: worstUsdcHumanAmount.round(types_1.BASE_DECIMALS, 0).toString(),
            zeroExResponseObject,
        };
    }
    async withdraw({ starkKey, }, options) {
        return this.contracts.send(this.contracts.starkwarePerpetual, this.contracts.starkwarePerpetual.methods.withdraw((0, ContractCallHelpers_1.starkKeyToUint256)(starkKey), Constants_1.COLLATERAL_ASSET_ID[this.contracts.networkId]), options);
    }
    async withdrawTo({ starkKey, recipient, }, options) {
        return this.contracts.send(this.contracts.starkwarePerpetual, this.contracts.starkwarePerpetual.methods.withdrawTo((0, ContractCallHelpers_1.starkKeyToUint256)(starkKey), Constants_1.COLLATERAL_ASSET_ID[this.contracts.networkId], recipient), options);
    }
    async forcedWithdrawalRequest({ starkKey, positionId, humanAmount, premiumCost, }, options) {
        return this.contracts.send(this.contracts.starkwarePerpetual, this.contracts.starkwarePerpetual.methods.forcedWithdrawalRequest((0, ContractCallHelpers_1.starkKeyToUint256)(starkKey), (0, ContractCallHelpers_1.bignumberableToUint256)(positionId), (0, ContractCallHelpers_1.humanCollateralAmountToUint256)(humanAmount), premiumCost), options);
    }
    // ============ Getters ============
    async getEthKey({ starkKey, }, options) {
        try {
            const result = await this.contracts.call(this.contracts.starkwarePerpetual.methods.getEthKey((0, ContractCallHelpers_1.starkKeyToUint256)(starkKey)), options);
            return result;
        }
        catch (e) {
            if (e.message && e.message.includes('USER_UNREGISTERED')) {
                return null;
            }
            throw e;
        }
    }
    async getWithdrawalBalance({ starkKey, }, options) {
        const result = await this.contracts.call(this.contracts.starkwarePerpetual.methods.getWithdrawalBalance((0, ContractCallHelpers_1.starkKeyToUint256)(starkKey), Constants_1.COLLATERAL_ASSET_ID[this.contracts.networkId]), options);
        return (0, ContractCallHelpers_1.uint256ToHumanCollateralTokenAmount)(result);
    }
    async hasCancellationRequest({ starkKey, vaultId, }, options) {
        const result = await this.contracts.call(this.contracts.starkwarePerpetual.methods.getCancellationRequest((0, ContractCallHelpers_1.starkKeyToUint256)(starkKey), Constants_1.COLLATERAL_ASSET_ID[this.contracts.networkId], (0, ContractCallHelpers_1.bignumberableToUint256)(vaultId)), options);
        return !new bignumber_js_1.default(result).isZero();
    }
    async hasForcedWithdrawalRequest({ starkKey, positionId, humanAmount, }, options) {
        const result = await this.contracts.call(this.contracts.starkwarePerpetual.methods.getForcedWithdrawalRequest((0, ContractCallHelpers_1.starkKeyToUint256)(starkKey), (0, ContractCallHelpers_1.bignumberableToUint256)(positionId), (0, ContractCallHelpers_1.humanCollateralAmountToUint256)(humanAmount)), options);
        return !new bignumber_js_1.default(result).isZero();
    }
}
exports.Exchange = Exchange;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRXhjaGFuZ2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvbW9kdWxlcy9FeGNoYW5nZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxvREFBeUI7QUFDekIsZ0VBQXFDO0FBRXJDLDhDQUcyQjtBQUMzQixnREFFMEI7QUFDMUIsb0VBS29DO0FBRXBDLDRDQUFnRDtBQUNoRCxvQ0FRa0I7QUFFbEIsTUFBYSxRQUFRO0lBR25CLFlBQ0UsU0FBb0I7UUFFcEIsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7SUFDN0IsQ0FBQztJQUVNLFVBQVU7UUFDZixPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsa0JBQWtCLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQztJQUMzRCxDQUFDO0lBRU0sc0JBQXNCO1FBQzNCLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxvQkFBb0IsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDO0lBQzdELENBQUM7SUFFTSxLQUFLLENBQUMsUUFBUSxDQUNuQixFQUNFLFVBQVUsRUFDVixRQUFRLEVBQ1IsU0FBUyxHQUtWLEVBQ0QsT0FBcUI7UUFFckIsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FDeEIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxrQkFBa0IsRUFDakMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxrQkFBa0IsQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUNwRCxVQUFVLEVBQ1YsSUFBQSx1Q0FBaUIsRUFBQyxRQUFRLENBQUMsRUFDM0IsU0FBUyxDQUNWLEVBQ0QsT0FBTyxDQUNSLENBQUM7SUFDSixDQUFDO0lBRU0sS0FBSyxDQUFDLGtCQUFrQixDQUM3QixFQUNFLFVBQVUsRUFDVixRQUFRLEVBQ1IsU0FBUyxFQUNULFVBQVUsRUFDVixXQUFXLEdBT1osRUFDRCxPQUFxQjtRQUVyQixPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUN4QixJQUFJLENBQUMsU0FBUyxD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